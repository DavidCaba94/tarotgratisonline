/*!
 * jaralax library
 * version: 0.2.1 public beta
 * http://jarallax.com/
 *
 * Copyright 2012, Jacko Hoogeveen
 * Dual licensed under the MIT or GPL Version 3 licenses.
 * http://jarallax.com/license.html
 *
 * Date: 2/29/2012
*/ function hasNumbers(t){return/\d/.test(t)}(Jarallax=function(t){if(this.jarallaxObject=[],this.animations=[],this.defaultValues=[],this.progress=0,this.controllers=[],this.maxProgress=1,void 0===t)this.controllers.push(new ControllerScroll);else if(t.length)this.controllers=t;else if("object"==typeof t)this.controllers.push(t);else throw Error('wrong controller data type: "'+typeof t+'". Expected "object" or "array"');for(var e=0;e<this.controllers.length;e++)this.controllers[e].activate(this)}).prototype.setProgress=function(t){for(t>1?t=1:t<0?t=0:this.progress=t,j=0;j<this.defaultValues.length;j++)this.defaultValues[j].activate(t);for(k=0;k<this.animations.length;k++)this.animations[k].activate(t);for(l=0;l<this.controllers.length;l++)this.controllers[l].update(t)},Jarallax.prototype.setDefault=function(t,e){if(!t)throw Error("no selector defined.");if(Jarallax.isValues(e)){var s=new JarallaxDefault(t,e);s.activate(),this.defaultValues.push(s)}},Jarallax.prototype.addStatic=function(t,e){if(!t)throw Error("no selector defined.");if(Jarallax.isValues(e)){var s=new JarallaxStatic(t,e[0],e[1]);this.defaultValues.push(s)}},Jarallax.prototype.addAnimation=function(t,e){if(!t)throw Error("no selector defined.");if(Jarallax.isValues(e))for(var s=0;s<e.length-1;s++)if(e[s]&&e[s+1]){if(e[s].progress&&e[s+1].progress)-1==e[s+1].progress.indexOf("%")&&this.maxProgress<e[s+1].progress&&(this.maxProgress=e[s+1].progress),this.animations.push(new JarallaxAnimation(t,e[s],e[s+1],this));else throw Error("no animation boundry found.")}else throw Error("bad animation data.")},(JarallaxDefault=function(t,e){this.selector=t,this.values=e}).prototype.activate=function(t){for(i in this.values)$(this.selector).css(i,this.values[i])},(JarallaxStatic=function(t,e,s){this.selector=t,this.values=values}).prototype.activate=function(t){var e,s;if(this.startValues.progress.indexOf("%")>=0?e=parseInt(this.startValues.progress,10)/100:hasNumbers(this.startValues.progress)&&(e=this.maxProgress/parseInt(this.startValues.progress,10)),this.endValues.progress.indexOf("%")>=0?s=parseInt(this.endValues.progress,10)/100:hasNumbers(this.endValues.progress)&&(s=this.maxProgress/parseInt(this.endValues.progress,10)),progress>e&&progress<s)for(i in this.startValues)"progress"!=i&&$(this.selector).css(i,this.startValues[i])},Jarallax.isValues=function(t){if(!t)throw Error("no values set.");if("object"!=typeof t)throw Error('wrong data type values. expected: "object", got: "'+typeof t+'"');if(0===t.size)throw Error("Got an empty values object");return!0},Jarallax.getUnits=function(t){return t.replace(/\d+/g,"")},Jarallax.EASING={linear:function(t,e,s,r,o){return t/r*s+e},easeOut:function(t,e,s,r,o){return void 0==o&&(o=2),(-1*Math.pow((r-t)/r,o)+1)*s+e},easeIn:function(t,e,s,r,o){return void 0==o&&(o=2),Math.pow(t/r,o)*s+e},easeInOut:function(t,e,s,r,o){return(void 0==o&&(o=2),s/=2,(t*=2)<r)?Math.pow(t/r,o)*s+e:(t-=r,(-1*Math.pow((r-t)/r,o)+1)*s+e+s)}},Jarallax.EASING.none=Jarallax.EASING.linear,(JarallaxAnimation=function(t,e,s,r){this.progress=0,this.selector=t,this.startValues=e,this.endValues=s,this.jarallax=r}).prototype.activate=function(t){if(this.progress!=t){if(r=void 0==this.startValues.style?{easing:"linear"}:this.startValues.style,this.startValues.progress.indexOf("%")>=0?e=parseInt(this.startValues.progress,10)/100:hasNumbers(this.startValues.progress)&&(e=parseInt(this.startValues.progress,10)/this.jarallax.maxProgress),this.endValues.progress.indexOf("%")>=0?s=parseInt(this.endValues.progress,10)/100:hasNumbers(this.endValues.progress)&&(s=parseInt(this.endValues.progress,10)/this.jarallax.maxProgress),this.startValues.event&&this.dispatchEvent(this.progress,t,e,s),t>=e&&t<=s){for(i in this.startValues)if("progress"!=i&&"style"!=i&&"event"!=i){if(void 0!=this.endValues[i]&&"display"!=i){var e,s,r,o=Jarallax.getUnits(this.startValues[i]+"");o=o.replace("-","");var a=parseFloat(this.startValues[i]),n=parseFloat(this.endValues[i]),h=s-e,p=t-e,u=n-a,c=Jarallax.EASING[r.easing](p,a,u,h,r.easing.power);c+=o,$(this.selector).css(i,c)}else $(this.selector).css(i,this.startValues[i])}}this.progress=t}},JarallaxAnimation.prototype.dispatchEvent=function(t,e,s,r){var o=this.startValues.event,a={};a.animation=this,a.selector=this.selector,e>=s&&e<=r?(o.start&&t<s&&(a.type="start",o.start(a)),o.animating&&(a.type="animating",o.animating(a)),o.forward&&t<e&&(a.type="forward",o.forward(a)),o.reverse&&t>e&&(a.type="reverse",o.reverse(a))):(o.complete&&t<r&&e>r&&(a.type="complete",o.complete(a)),o.rewinded&&t>s&&e<s&&(a.type="rewinded",o.rewinded(a)))},(ControllerScroll=function(){this.height=parseInt(jQuery("body").css("height"),10),this.target=$(window),this.scrollSpace=this.height-this.target.height()}).prototype.activate=function(t){this.jarallax=t,this.target.bind("scroll",{me:this},this.onScroll)},ControllerScroll.prototype.deactivate=function(t){},ControllerScroll.prototype.onScroll=function(t){var e=t.data.me,s=e.target.scrollTop()/e.scrollSpace;e.jarallax.setProgress(s)},ControllerScroll.prototype.update=function(t){},(ControllerTime=function(t,e){this.interval=e,this.speed=t,this.forward=!0}).prototype.onInterval=function(){this.jarallax.setProgress(this.progress),$("body").scrollTop(parseInt(jQuery("body").css("height"),10)*this.progress),this.progress>=1?(this.progress=1,this.forward=!1):this.progress<=0&&(this.progress=0,this.forward=!0),this.forward?this.progress+=this.speed:this.progress-=this.speed},ControllerTime.prototype.activate=function(t){this.jarallax=t,this.progress=0,this.interval=$.interval(this.onInterval.bind(this),this.interval)},ControllerTime.prototype.deactivate=function(t){},ControllerTime.prototype.update=function(t){},(ControllerDrag=function(t,e,s){this.object=$(t),this.start=e,this.end=s,this.container="",this.width,this.startX=0,this.startY=0}).prototype.activate=function(t){this.jarallax=t,this.container="#scrollbar",this.object.draggable({containment:this.container,axis:"x"}),this.object.bind("drag",{me:this},this.onDrag),this.container=$(this.container),this.width=$(this.container).innerWidth()-this.object.outerWidth()},ControllerDrag.prototype.onDrag=function(t){var e=parseInt($(this).css("left"),10)/t.data.me.width;t.data.me.jarallax.setProgress(e)},ControllerDrag.prototype.deactivate=function(t){},ControllerDrag.prototype.update=function(t){this.object.css("left",t*this.width)},(ControllerKeyboard=function(t,e,s){this.repetitiveInput=s,this.preventDefault=e||!1,this.keys=t||{38:-.01,40:.01},this.keysState={}}).prototype.activate=function(t){for(key in this.jarallax=t,$(document.documentElement).keydown({me:this},this.keyDown),$(document.documentElement).keyup({me:this},this.keyUp),this.keys)this.keysState[key]=!1},ControllerKeyboard.prototype.deactivate=function(t){},ControllerKeyboard.prototype.keyDown=function(t){var e=t.data.me;for(key in e.keys)key==t.keyCode&&((!0!==e.keysState[key]||e.repetitiveInput)&&e.jarallax.setProgress(e.jarallax.progress+e.keys[key]),e.keysState[key]=!0,e.preventDefault&&t.preventDefault())},ControllerKeyboard.prototype.keyUp=function(t){var e=t.data.me;for(key in e.keys)key==t.keyCode&&(e.keysState[key]=!1)},ControllerKeyboard.prototype.update=function(t){},(ControllerMousewheel=function(t,e){this.sensitivity=-t,this.preventDefault=e||!1}).prototype.activate=function(t){this.jarallax=t,$("body").bind("mousewheel",{me:this},this.onScroll)},ControllerMousewheel.prototype.deactivate=function(t){this.jarallax=t},ControllerMousewheel.prototype.onScroll=function(t,e){(controller=t.data.me).jarallax.setProgress(controller.jarallax.progress+controller.sensitivity*e),controller.preventDefault&&t.preventDefault()},ControllerMousewheel.prototype.update=function(t){},(ControllerIpadScroll=function(){this.x=0,this.previousX=-1,this.top=700,this.moveRight=!1}).prototype.activate=function(t,e){this.jarallax=t,this.values=e,$("body").bind("touchmove",{me:this},this.onScroll)},ControllerIpadScroll.prototype.onScroll=function(t){t.preventDefault();var e=t.data.me,s=t.originalEvent.touches.item(0);-1==e.previousX?e.previousX=s.clientX:(s.clientX-e.previousX<100&&s.clientX-e.previousX>-100&&(e.moveRight?e.x-=s.clientX-e.previousX:e.x+=s.clientX-e.previousX,e.x=e.x<1e3?e.x:1e3,e.x=e.x>0?e.x:0),e.previousX=s.clientX,e.jarallax.setProgress(e.x/e.top))},ControllerIpadScroll.prototype.deactivate=function(t){},ControllerIpadScroll.prototype.update=function(t){};